SOURCES := $(wildcard *.c)
OBJECTS := $(SOURCES:%.c=%.o)
CC      := @CC@ -std=c99 @CFLAGS@
CFLAGS  := -Wall -pedantic -I.
LDFLAGS := -Wall @LIBS@

all: init init.static

%.o: %.c
	$(CC) $(CFLAGS) -c $< -o $@

init: $(OBJECTS)
	$(CC) $(OBJECTS) $(LDFLAGS) -o $@

init.static: $(OBJECTS)
	$(CC) $(OBJECTS) $(LDFLAGS) -static -o $@

clean:
	rm -f $(OBJECTS) init init.static

distclean: clean
	rm -f Makefile
